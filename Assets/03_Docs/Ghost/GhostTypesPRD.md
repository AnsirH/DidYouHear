# 요구사항 명세서: 귀신 종류별 시스템

## 1. 개요

게임에는 총 3종류의 귀신이 존재하며, 각각 다른 행동 패턴과 게임 오버 조건을 가진다. 귀신들은 플레이어의 잘못된 행동이나 반응 실패 시 등장하여 **즉시 게임 오버** 또는 **추격 이벤트**를 유발한다. 모든 귀신은 동일한 게임 오버 연출을 사용하지만, 모델링은 종류별로 다르게 구현된다.

---

## 2. 목적

- **다양한 공포 요소**를 제공하여 게임의 긴장감을 극대화한다.
- 각 귀신의 **고유한 행동 패턴**을 통해 플레이어에게 다양한 도전을 제공한다.
- **즉시 게임 오버**와 **추격 이벤트**를 구분하여 공포의 강도를 조절한다.
- 플레이어의 **반응 능력과 판단력**을 시험하는 핵심 메커니즘을 제공한다.

---

## 3. 기능 요구사항 상세

### [REQ-GHOSTTYPE-01] 복도 귀신 (Corridor Ghost)

- **설명**: 복도에서 어깨를 치거나 공깃돌 소리를 차단하는 귀신으로, 잘못된 대응 시 즉시 게임 오버가 된다.
- **세부 조건**:
    - **어깨 두드림 이벤트**: 플레이어가 어깨가 두드려진 방향으로 뒤돌아보면 즉시 게임 오버
    - **공깃돌 소리 차단**: 공깃돌을 던졌을 때 소리가 나지 않게 함. 이 때 플레이어는 자리에 멈춰야 하며 적정 시간 내 멈추지 않고 계속 이동하면 즉시 게임 오버
        - 플레이어는 자리에 멈췄으면 소리가 날 때까지 수동으로 공깃돌을 던져야 한다.
        - 공깃돌 소리가 난다면 이동 가능
        - 소리가 나지 않는 상태에서 뒤를 돌아보면 즉시 게임 오버
    - **특별한 상황**: 공깃돌 소리가 나지 않아 멈춘 상태에서 어깨 두드림 발생 시
        - 플레이어는 뒤돌아보지 않고 공깃돌을 수동으로 던져 소리가 날 때까지 대기( 뒤돌아보면 즉시 게임 오버 )
        - 어깨 두드림 발생 시 반대 방향으로 고개를 돌려야 멈춤 상태 해제
        - 잘못된 방향으로 고개를 돌리면 즉시 게임 오버
    - **게임 오버 조건**: 즉시 게임 오버 (추격 없음)

---

### [REQ-GHOSTTYPE-02] 교실 귀신 (Classroom Ghost)

- **설명**: 교실에서 불을 켜거나 문을 닫거나 창문을 치는 귀신으로, 잘못된 대응 시 추격 이벤트가 발생한다.
- **세부 조건**:
    - **교실 불 켜짐**: 교실 복도 조각에서 교실 불이 갑자기 켜짐
    - **문 닫기**: 교실 문이 갑자기 닫히는 소리와 시각적 연출
    - **창문 치기**: 창문을 세게 치는 소리와 카메라 떨림 효과
    - **대응 방법**: 이벤트 발생 시 반드시 숙이기(Crouch) 상태로 이동
    - **잘못된 대응**: 숙이지 않고 계속 이동하거나 무시할 경우
    - **게임 오버 조건**: 추격 이벤트 발생 → 플레이어가 따라잡히면 게임 오버

---

### [REQ-GHOSTTYPE-03] 화장실 귀신 (Bathroom Ghost)

- **설명**: 화장실에서 물을 트는 귀신으로, 잘못된 대응 시 추격 이벤트가 발생한다.
- **세부 조건**:
    - **물 틀기**: 화장실에서 물이 갑자기 틀리는 소리와 시각적 연출
    - **물방울 소리**: 물방울이 떨어지는 소리가 나다가 갑자기 물 틀리는 소리로 전환
    - **대응 방법**: 이벤트 발생 시 반드시 숙이기(Crouch) 상태로 이동
    - **잘못된 대응**: 숙이지 않고 계속 이동하거나 무시할 경우
    - **게임 오버 조건**: 추격 이벤트 발생 → 플레이어가 따라잡히면 게임 오버

---

### [REQ-GHOSTTYPE-04] 귀신 등장 조건 및 우선순위

- **설명**: 여러 귀신이 동시에 등장할 수 있는 상황에 대한 처리 규칙
- **세부 조건**:
    - **복도 귀신 우선순위**: 공깃돌 소리 차단과 어깨 두드림이 동시 발생 시 어깨 두드림에 대한 대응을 우선 처리
    - **환경 이벤트 우선순위**: 교실 귀신과 화장실 귀신은 동시에 발생하지 않음
    - **특별한 상황 처리**: 공깃돌 소리가 안 나서 멈춘 상태에서 어깨 두드림 발생
        - 플레이어는 뒤돌아보지 않고 소리가 날 때까지 공깃돌을 수동으로 던져 확인( 소리가 안 나는 상태에서 이동 시 즉시 게임 오버 )
        - 어깨 두드림 발생 시 반대 방향으로 고개를 돌리면 멈춤 상태 해제
        - 잘못된 방향으로 고개를 돌리면 즉시 게임 오버

---

### [REQ-GHOSTTYPE-05] 추격 상황에서의 복도 귀신 이벤트

- **설명**: 교실/화장실 귀신에 의해 추격당하는 상황에서도 복도 귀신의 이벤트가 발생할 수 있다.
- **세부 조건**:
    - **추격 중 이벤트 발생**: 교실/화장실 귀신 추격 중에도 공깃돌 소리 차단과 어깨 두드림 이벤트 발생 가능
    - **공깃돌 소리 차단 시 대응**:
        - 추격 중 공깃돌 소리가 나지 않으면 **즉시 멈춰야 함** (1~2초 내)
        - 멈춘 상태에서 공깃돌을 수동으로 던져 소리가 날 때까지 대기
        - 소리가 나면 다시 달리기 상태로 전환하여 추격 회피 계속
        - 소리가 나지 않는 상태에서 이동하면 즉시 게임 오버
    - **어깨 두드림 이벤트 시 대응**:
        - 추격 중 어깨 두드림 발생 시 반대 방향으로 고개를 돌려야 함
        - 잘못된 방향으로 고개를 돌리면 즉시 게임 오버
        - 올바른 반응 시 추격 상황 유지
    - **추격 중 뒤돌아보기 제한**:
        - 추격 상황에서 뒤를 3초 이상 보면 즉시 게임 오버
        - 뒤를 보고 있는 동안 카메라 시점이 점점 괴이해짐
        - 시각적 표현: 화면 왜곡, 색상 변화, 시야 좁아짐, 깜빡임 효과
        - 2초 경과 시 경고 효과 (화면 가장자리 빨간색 깜빡임)
        - 3초 경과 시 즉시 게임 오버 연출 시작
    - **추격 귀신과의 거리 계산**:
        - 플레이어와 추격하는 귀신 간의 거리를 **실시간으로 계산**
        - 공깃돌 소리 차단 시간(1~2초) 동안 추격 귀신이 접근할 수 있는 거리 고려
    - **게임 오버 조건**:
        - 공깃돌 소리 차단 시 적절한 시간 내 멈추지 않으면 즉시 게임 오버
        - 어깨 두드림 시 잘못된 방향으로 고개를 돌리면 즉시 게임 오버
        - 추격 중 뒤를 3초 이상 보면 즉시 게임 오버
        - 추격 귀신에게 잡히면 게임 오버 (기존 추격 시스템)

---

### [REQ-GHOSTTYPE-06] 게임 오버 연출

- **설명**: 모든 귀신 종류가 동일한 게임 오버 연출을 사용한다.
- **세부 조건**:
    - **즉시 게임 오버**: 복도 귀신의 잘못된 대응 시
    - **추격 후 게임 오버**: 교실/화장실 귀신의 잘못된 대응 후 추격에서 잡힐 때
    - **연출 요소**:
        - 카메라 강제 뒤돌림
        - 귀신 등장 애니메이션 (0.3초 이내 시작)
        - 화면 점멸 및 왜곡 효과
        - 공포 사운드 재생
        - 1~2초 후 게임 오버 화면 전환

---

### [REQ-GHOSTTYPE-07] 귀신 모델링 및 시각적 구분

- **설명**: 각 귀신 종류별로 다른 모델링을 사용하여 시각적으로 구분한다.
- **세부 조건**:
    - **복도 귀신**: 어두운 실루엣, 불안정한 형태
    - **교실 귀신**: 교실과 관련된 요소 (칠판, 책상 등)가 포함된 형태
    - **화장실 귀신**: 화장실과 관련된 요소 (거울, 세면대 등)가 포함된 형태
    - **공통 요소**: 모든 귀신은 동일한 크기와 기본 형태를 가짐
    - **차별화 요소**: 세부 디테일과 색상, 텍스처만 다름

---

## 4. 비기능 요구사항

- 귀신 등장 판정은 **0.1초 단위**로 정확하게 처리되어야 한다.
- 복도 귀신의 특별한 상황(공깃돌 + 어깨 두드림) 처리는 **우선순위가 높아야** 한다.
- 추격 이벤트는 **60FPS 유지**에 영향을 주지 않도록 최적화되어야 한다.
- 귀신 모델링은 **메모리 효율적**으로 로드/언로드되어야 한다.
- 플레이어와 추격 귀신 간의 **거리 계산은 프레임마다 업데이트**되어야 한다.
- **추격 중 뒤돌아보기 타이머**는 0.1초 단위로 정확하게 측정되어야 한다.
- **시각적 왜곡 효과**는 60FPS에서도 부드럽게 처리되어야 한다.

---

## 5. 예외 처리

- **추격 이벤트 중복**: 여러 귀신이 동시에 추격을 시작할 경우, 가장 먼저 발생한 이벤트만 유효
- **모델링 로드 실패**: 귀신 모델링 로드 실패 시 기본 모델로 대체
- **이벤트 충돌**: 복도 귀신과 환경 이벤트가 동시 발생 시 복도 귀신 로직 우선 적용
- **추격 중 멈춤 실패**: 공깃돌 소리 차단 시 1~2초 내 멈추지 못하면 즉시 게임 오버 처리
- **추격 중 뒤돌아보기 중복**: 어깨 두드림 이벤트와 뒤돌아보기 제한이 동시 발생 시 어깨 두드림 우선 처리
