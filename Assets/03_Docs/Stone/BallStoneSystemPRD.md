# 요구사항 명세서: 공깃돌 시스템

## 1. 개요

플레이어는 걷거나 달리는 동안 주기적으로 공깃돌을 어깨 너머로 던진다. 공깃돌이 바닥에 닿을 때 나는 소리는 플레이어가 안전하게 이동 중임을 확인하는 중요한 피드백이다. 만약 소리가 나지 않거나 플레이어가 올바르게 반응하지 않을 경우, 귀신이 등장하여 게임이 종료된다.

---

## 2. 목적

- 공깃돌을 통한 **소리 기반 피드백**으로 플레이어의 긴장감을 극대화한다.
- 걷기/달리기 상태와 밀접하게 연계하여 플레이어의 이동 방식에 따른 **위험도 차이**를 제공한다.
- 랜덤성과 즉각적인 반응 요구를 통해 게임의 긴장감을 유지한다.

---

## 3. 기능 요구사항 상세

### [REQ-STONE-01] 공깃돌 자동 던지기

- **설명**: 플레이어가 걷거나 숙이거나 달릴 때 일정 주기로 자동으로 공깃돌을 던진다.
- **세부 조건**:
    - 걷기/숙이기 상태 → 3~5초 주기로 던짐.
    - 달리기 상태 → 1.5~2.5초 주기로 던짐.
    - 멈추기 상태 → 공깃돌을 던지지 않는다.
    - 던지는 방향은 항상 플레이어의 어깨 뒤쪽.

---

### [REQ-STONE-02] 공깃돌 수동 던지기

- **설명**: 플레이어가 멈췄을 때 수동으로 공깃돌을 던질 수 있도록 한다.
- **세부 조건**:
    - 멈추기 상태에서만 공깃돌 던지기 버튼 활성화.
    - 플레이어가 공깃돌 던지기 버튼을 눌러 수동으로 던질 수 있음.
    - 공깃돌을 던지는 딜레이는 0.5초. ( 공깃돌을 던지고 0.5초 뒤에 던질 수 있음 )
    - 던지는 방향은 항상 플레이어의 어깨 뒤쪽.

---

### [REQ-STONE-03] 충돌음 재생

- **설명**: 공깃돌이 바닥에 닿으면 반드시 충돌음이 재생된다.
- **세부 조건**:
    - 충돌음은 플레이어 기준으로 뒤쪽 방향성 사운드로 구현.
    - 충돌음 볼륨은 환경 소음보다 살짝 크게 설정.
    - 충돌음은 랜덤한 음색 차이를 가져야 한다(자연스러움 강화).
    - **첫 번째 착지에서만 사운드 재생**: 바운스 시에는 사운드가 재생되지 않음.

---

### [REQ-STONE-04] 충돌음 누락 시 대응

- **설명**: 공깃돌이 던져졌는데도 소리가 나지 않을 경우, 플레이어는 즉시 걷기를 멈춰야 한다.
- **세부 조건**:
    - 플레이어가 멈추면 안전하게 게임 진행 지속.
    - 멈춘 뒤 1~2초 후 정상적으로 다시 이동 가능.
    - 멈춘 상태에서는 공깃돌이 추가로 던져지지 않는다.

---

### [REQ-STONE-05] 잘못된 반응 시 귀신 등장

- **설명**: 충돌음이 없는데도 플레이어가 계속 이동하면 귀신이 등장한다.
- **세부 조건**:
    - 시스템은 즉시 플레이어 카메라를 강제로 뒤돌리게 한다.
    - 귀신 연출이 화면에 등장하며 즉시 게임 오버 처리.
    - 게임 오버 전, 짧은 점멸 효과와 섬뜩한 사운드가 재생되어 긴장감을 극대화한다.

---

## 4. 비기능 요구사항

- 공깃돌 던지기 애니메이션은 짧고 반복 가능해야 하며, 이동 동작과 충돌 없이 자연스럽게 연출되어야 한다.
- 충돌음은 **0.3초 이내**에 재생되어야 하며, 오디오 지연이 없어야 한다.
- 10회 이상 연속 플레이 시에도 랜덤 충돌음 변주가 충분히 다양해야 한다.

---

## 5. 예외 처리

- 공깃돌이 충돌할 표면이 없는 경우(예: 구멍이나 끝 없는 공간)에도 충돌음은 무조건 발생해야 한다.
- 만약 사운드 재생 시스템 오류로 충돌음이 발생하지 않을 경우, 게임 로직 상에서는 “충돌음 없음” 상황으로 처리한다.
- 귀신 연출이 시작되면 모든 이동 입력은 무시되고 게임 오버 연출만 재생된다.