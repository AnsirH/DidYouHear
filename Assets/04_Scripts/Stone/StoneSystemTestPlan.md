# 공깃돌 시스템 테스트 계획

## 📋 개요
지금까지 구현한 공깃돌 시스템의 기능을 체계적으로 테스트하기 위한 계획서입니다.

---

## 🎯 테스트 대상 시스템

### 1. StoneProjectile (공깃돌 발사체)
- **파일**: `StoneProjectile.cs`
- **주요 기능**: 충돌 감지, 바운스, 생명주기, 물리 상태 관리

### 2. StonePool (오브젝트 풀)
- **파일**: `StonePool.cs`
- **주요 기능**: Unity ObjectPool 사용, 오브젝트 재사용, 메모리 관리

### 3. StoneThrower (던지기 시스템)
- **파일**: `StoneThrower.cs`
- **주요 기능**: 자동/수동 던지기, 이동 상태별 간격 조절

### 4. AudioManager (3D 오디오)
- **파일**: `AudioManager.cs`
- **주요 기능**: 3D 공간 오디오, 사운드 풀링

---

## 🧪 상세 테스트 계획

### **1. StoneProjectile 단위 테스트**

#### 1.1 초기화 테스트
- [ ] **OnEnable 테스트**: 오브젝트 활성화 시 Initialize() 자동 호출 확인
- [ ] **상태 초기화 테스트**: currentLifetime, bounceCount, hasLanded 초기값 확인
- [ ] **물리 상태 리셋 테스트**: velocity, angularVelocity가 0으로 리셋되는지 확인

#### 1.2 생명주기 테스트
- [ ] **Lifetime 감소 테스트**: 시간에 따라 currentLifetime이 감소하는지 확인
- [ ] **자동 파괴 테스트**: lifetime 초과 시 자동으로 풀에 반환되는지 확인
- [ ] **OnDisable 테스트**: 비활성화 시 ResetPhysicsState() 자동 호출 확인

#### 1.3 충돌 감지 테스트
- [ ] **바닥 충돌 테스트**: IsGroundCollision() 메서드 정확성 확인
- [ ] **첫 착지 테스트**: 첫 번째 바닥 충돌 시 hasLanded = true 설정 확인
- [ ] **바운스 테스트**: 최대 바운스 횟수 제한이 올바르게 작동하는지 확인

#### 1.4 사운드 테스트
- [ ] **충돌음 재생 테스트**: AudioManager를 통한 3D 사운드 재생 확인
- [ ] **피치 랜덤화 테스트**: 사운드 피치가 랜덤하게 적용되는지 확인

### **2. StonePool 테스트**

#### 2.1 풀 생성 테스트
- [ ] **ObjectPool 초기화 테스트**: Unity ObjectPool이 올바르게 생성되는지 확인
- [ ] **기본 용량 테스트**: defaultCapacity만큼 오브젝트가 생성되는지 확인
- [ ] **프리팹 설정 테스트**: stonePrefab이 올바르게 설정되는지 확인

#### 2.2 오브젝트 관리 테스트
- [ ] **GetStone 테스트**: 풀에서 오브젝트를 올바르게 가져오는지 확인
- [ ] **ReturnStone 테스트**: 오브젝트를 풀로 올바르게 반환하는지 확인
- [ ] **활성 오브젝트 추적 테스트**: activeStones 리스트가 올바르게 관리되는지 확인

#### 2.3 풀 확장 테스트
- [ ] **자동 확장 테스트**: maxSize 초과 시 풀이 확장되는지 확인
- [ ] **메모리 제한 테스트**: maxSize를 초과하지 않는지 확인
- [ ] **컬렉션 체크 테스트**: collectionChecks 옵션이 올바르게 작동하는지 확인

#### 2.4 통계 테스트
- [ ] **CountAll 테스트**: 전체 오브젝트 수가 올바르게 계산되는지 확인
- [ ] **CountActive 테스트**: 활성 오브젝트 수가 올바르게 계산되는지 확인
- [ ] **CountInactive 테스트**: 비활성 오브젝트 수가 올바르게 계산되는지 확인

### **3. StoneThrower 테스트**

#### 3.1 자동 던지기 테스트
- [ ] **이동 중 자동 던지기**: 플레이어가 이동 중일 때 자동으로 공깃돌이 던져지는지 확인
- [ ] **정지 시 중단**: 플레이어가 정지하면 자동 던지기가 중단되는지 확인
- [ ] **간격 조절 테스트**: 이동 상태별 던지기 간격이 올바른지 확인

#### 3.2 수동 던지기 테스트
- [ ] **Idle 상태 던지기**: Idle 상태에서만 수동 던지기가 가능한지 확인
- [ ] **Space키 입력**: Space키 입력이 올바르게 처리되는지 확인
- [ ] **쿨다운 테스트**: 수동 던지기 쿨다운이 올바르게 작동하는지 확인

#### 3.3 던지기 로직 테스트
- [ ] **던지기 방향 테스트**: 공깃돌이 뒤쪽으로 던져지는지 확인
- [ ] **랜덤성 테스트**: 던지기 방향에 랜덤성이 적용되는지 확인
- [ ] **힘 적용 테스트**: throwForce가 올바르게 적용되는지 확인

#### 3.4 상태 관리 테스트
- [ ] **이동 상태 변경**: PlayerMovement 상태 변경에 따른 던지기 간격 조절 확인
- [ ] **던지기 제어**: canThrow 플래그에 따른 던지기 제어 확인
- [ ] **이벤트 발생**: 던지기 이벤트가 올바르게 발생하는지 확인

### **4. AudioManager 테스트**

#### 4.1 3D 오디오 테스트
- [ ] **3D 사운드 재생**: Play3DSound()가 올바르게 작동하는지 확인
- [ ] **거리 기반 볼륨**: 거리에 따른 볼륨 조절이 올바른지 확인
- [ ] **방향성 사운드**: 사운드 방향성이 올바르게 적용되는지 확인

#### 4.2 사운드 풀링 테스트
- [ ] **AudioSource 풀링**: AudioSource가 올바르게 풀링되는지 확인
- [ ] **사운드 완료 처리**: 사운드 재생 완료 시 풀로 반환되는지 확인
- [ ] **풀 확장**: AudioSource 풀이 필요시 확장되는지 확인

#### 4.3 볼륨 관리 테스트
- [ ] **마스터 볼륨**: masterVolume 설정이 올바르게 적용되는지 확인
- [ ] **SFX 볼륨**: sfxVolume 설정이 올바르게 적용되는지 확인
- [ ] **볼륨 업데이트**: 볼륨 변경 시 기존 사운드에 적용되는지 확인

### **5. 통합 테스트**

#### 5.1 전체 시스템 테스트
- [ ] **시스템 연동**: 모든 시스템이 함께 올바르게 작동하는지 확인
- [ ] **이벤트 체인**: 이벤트가 시스템 간 올바르게 전달되는지 확인
- [ ] **상태 동기화**: 각 시스템의 상태가 올바르게 동기화되는지 확인

#### 5.2 성능 테스트
- [ ] **프레임레이트**: 시스템이 프레임레이트에 영향을 주지 않는지 확인
- [ ] **메모리 사용량**: 메모리 사용량이 안정적인지 확인
- [ ] **가비지 컬렉션**: 불필요한 가비지 컬렉션이 발생하지 않는지 확인

#### 5.3 스트레스 테스트
- [ ] **대량 던지기**: 많은 수의 공깃돌을 동시에 던져도 안정적인지 확인
- [ ] **연속 사용**: 오랜 시간 사용해도 메모리 누수가 없는지 확인
- [ ] **빠른 반복**: 빠른 속도로 반복 사용해도 안정적인지 확인

---

## 🛠️ 테스트 구현 우선순위

### **Phase 1: 기본 기능 테스트**
1. StoneProjectile 초기화/리셋 테스트
2. StonePool 기본 CRUD 테스트
3. StoneThrower 기본 던지기 테스트

### **Phase 2: 고급 기능 테스트**
1. 충돌 감지 및 바운스 테스트
2. 3D 오디오 테스트
3. 풀 확장 및 메모리 관리 테스트

### **Phase 3: 통합 및 성능 테스트**
1. 전체 시스템 통합 테스트
2. 성능 및 스트레스 테스트
3. 엣지 케이스 테스트

---

## 📝 테스트 결과 기록

### **테스트 실행 일자**: [날짜 입력]
### **테스트 환경**: Unity [버전], [플랫폼]
### **테스트 결과**:
- [ ] 모든 테스트 통과
- [ ] 일부 테스트 실패 (상세 내용 기록)
- [ ] 성능 이슈 발견 (상세 내용 기록)

### **발견된 이슈**:
1. [이슈 1]
2. [이슈 2]
3. [이슈 3]

### **개선 사항**:
1. [개선 1]
2. [개선 2]
3. [개선 3]

---

**마지막 업데이트**: [날짜]
**다음 테스트 예정**: [날짜]
